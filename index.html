<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mini Idle Game</title>
    <style>
      :root {
        color-scheme: dark;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        background: radial-gradient(circle at top, #1f2937, #0b1020 60%);
        font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif;
        color: #e2e8f0;
      }

      .game {
        width: min(92vw, 880px);
        border: 1px solid #334155;
        border-radius: 14px;
        background: rgba(15, 23, 42, 0.9);
        box-shadow: 0 22px 45px rgba(2, 6, 23, 0.55);
        overflow: hidden;
      }

      .header {
        padding: 14px 18px;
        border-bottom: 1px solid #334155;
        background: rgba(30, 41, 59, 0.75);
        font-size: 18px;
        font-weight: 700;
      }

      .arena {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 14px;
        padding: 16px;
      }

      .panel {
        padding: 14px;
        border: 1px solid #334155;
        border-radius: 10px;
        background: rgba(15, 23, 42, 0.65);
      }

      .name {
        font-size: 20px;
        font-weight: 700;
        margin: 0 0 10px;
      }

      .stat {
        margin: 6px 0;
        font-size: 14px;
      }

      .bar {
        width: 100%;
        height: 14px;
        border-radius: 999px;
        overflow: hidden;
        background: #1e293b;
        border: 1px solid #334155;
        margin-top: 6px;
      }

      .bar > span {
        display: block;
        height: 100%;
        transition: width 0.18s ease;
      }

      .hero-bar > span {
        background: linear-gradient(90deg, #0ea5e9, #2563eb);
      }

      .monster-bar > span {
        background: linear-gradient(90deg, #f97316, #ef4444);
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding: 0 16px 16px;
      }

      button {
        border: 1px solid #334155;
        border-radius: 8px;
        background: #1e293b;
        color: #e2e8f0;
        padding: 9px 12px;
        font-weight: 600;
        cursor: pointer;
      }

      button:hover {
        background: #334155;
      }

      .log {
        margin: 0 16px 16px;
        border: 1px solid #334155;
        border-radius: 10px;
        padding: 10px;
        height: 170px;
        overflow: auto;
        background: rgba(2, 6, 23, 0.65);
        font-size: 13px;
        line-height: 1.45;
      }

      .badge {
        display: inline-block;
        margin-left: 8px;
        font-size: 12px;
        color: #f8fafc;
        background: #16a34a;
        border-radius: 999px;
        padding: 3px 8px;
      }
    </style>
  </head>
  <body>
    <main class="game">
      <header class="header">
        ë¯¸ë‹ˆ ë°©ì¹˜í˜• ì „íˆ¬ ë°ëª¨
        <span class="badge" id="statusBadge">ìë™ ì „íˆ¬ ON</span>
      </header>

      <section class="arena">
        <article class="panel">
          <h2 class="name">ê¸°ì‚¬</h2>
          <p class="stat" id="heroLevel"></p>
          <p class="stat" id="heroAtk"></p>
          <p class="stat" id="heroHpText"></p>
          <div class="bar hero-bar"><span id="heroHpBar"></span></div>
        </article>

        <article class="panel">
          <h2 class="name" id="monsterName">ê³ ë¸”ë¦°</h2>
          <p class="stat" id="monsterLevel"></p>
          <p class="stat" id="monsterAtk"></p>
          <p class="stat" id="monsterHpText"></p>
          <div class="bar monster-bar"><span id="monsterHpBar"></span></div>
        </article>
      </section>

      <section class="controls">
        <button id="toggleAutoBtn">ìë™ ì „íˆ¬ ì¼ì‹œì •ì§€</button>
        <button id="manualAttackBtn">ìˆ˜ë™ ê³µê²©</button>
        <button id="healBtn">íšŒë³µ ë¬¼ì•½ ì‚¬ìš©</button>
        <button id="resetBtn">ì´ˆê¸°í™”</button>
      </section>

      <section class="log" id="log"></section>
    </main>

    <script>
      (() => {
        const heroNames = ['ê³ ë¸”ë¦°', 'ìŠ¬ë¼ì„', 'ì˜¤í¬', 'ë‹¤í¬ ë‚˜ì´íŠ¸', 'ê³¨ë ˜'];

        const state = {
          auto: true,
          tickMs: 700,
          gold: 0,
          kills: 0,
          hero: {
            level: 1,
            maxHp: 140,
            hp: 140,
            atk: 18,
          },
          monster: null,
        };

        const el = {
          statusBadge: document.getElementById('statusBadge'),
          heroLevel: document.getElementById('heroLevel'),
          heroAtk: document.getElementById('heroAtk'),
          heroHpText: document.getElementById('heroHpText'),
          heroHpBar: document.getElementById('heroHpBar'),
          monsterName: document.getElementById('monsterName'),
          monsterLevel: document.getElementById('monsterLevel'),
          monsterAtk: document.getElementById('monsterAtk'),
          monsterHpText: document.getElementById('monsterHpText'),
          monsterHpBar: document.getElementById('monsterHpBar'),
          toggleAutoBtn: document.getElementById('toggleAutoBtn'),
          manualAttackBtn: document.getElementById('manualAttackBtn'),
          healBtn: document.getElementById('healBtn'),
          resetBtn: document.getElementById('resetBtn'),
          log: document.getElementById('log'),
        };

        function createMonster() {
          const level = Math.floor(state.kills / 4) + 1;
          const name = heroNames[(level - 1) % heroNames.length];
          const maxHp = 70 + level * 24;
          const atk = 7 + level * 3;
          return { name, level, maxHp, hp: maxHp, atk };
        }

        function writeLog(message) {
          const time = new Date().toLocaleTimeString('ko-KR', { hour12: false });
          el.log.innerHTML = `<div>[${time}] ${message}</div>` + el.log.innerHTML;
        }

        function render() {
          const { hero, monster } = state;
          el.statusBadge.textContent = state.auto ? 'ìë™ ì „íˆ¬ ON' : 'ìë™ ì „íˆ¬ OFF';
          el.statusBadge.style.background = state.auto ? '#16a34a' : '#475569';

          el.heroLevel.textContent = `Lv.${hero.level} | ê³¨ë“œ ${state.gold} | ì²˜ì¹˜ ${state.kills}`;
          el.heroAtk.textContent = `ê³µê²©ë ¥: ${hero.atk}`;
          el.heroHpText.textContent = `HP: ${hero.hp}/${hero.maxHp}`;
          el.heroHpBar.style.width = `${Math.max(0, (hero.hp / hero.maxHp) * 100)}%`;

          el.monsterName.textContent = monster.name;
          el.monsterLevel.textContent = `Lv.${monster.level}`;
          el.monsterAtk.textContent = `ê³µê²©ë ¥: ${monster.atk}`;
          el.monsterHpText.textContent = `HP: ${monster.hp}/${monster.maxHp}`;
          el.monsterHpBar.style.width = `${Math.max(0, (monster.hp / monster.maxHp) * 100)}%`;

          el.toggleAutoBtn.textContent = state.auto ? 'ìë™ ì „íˆ¬ ì¼ì‹œì •ì§€' : 'ìë™ ì „íˆ¬ ì¬ê°œ';
        }

        function levelUpIfNeeded() {
          const nextLevel = Math.floor(state.kills / 5) + 1;
          if (nextLevel > state.hero.level) {
            state.hero.level = nextLevel;
            state.hero.maxHp += 14;
            state.hero.atk += 4;
            state.hero.hp = state.hero.maxHp;
            writeLog(`ğŸ‰ ë ˆë²¨ ì—…! ê¸°ì‚¬ Lv.${state.hero.level} (ATK +4)`);
          }
        }

        function fightOnce(byManual = false) {
          const { hero, monster } = state;
          if (hero.hp <= 0) {
            writeLog('â˜ ï¸ ê¸°ì‚¬ê°€ ì“°ëŸ¬ì ¸ 30% ì²´ë ¥ìœ¼ë¡œ ë¶€í™œí•©ë‹ˆë‹¤.');
            hero.hp = Math.floor(hero.maxHp * 0.3);
          }

          monster.hp -= hero.atk;
          writeLog(`${byManual ? 'ğŸ–±ï¸ ìˆ˜ë™' : 'âš”ï¸ ìë™'} ê³µê²©! ${monster.name}ì—ê²Œ ${hero.atk} í”¼í•´.`);

          if (monster.hp <= 0) {
            const reward = 12 + monster.level * 4;
            state.gold += reward;
            state.kills += 1;
            writeLog(`âœ… ${monster.name} ì²˜ì¹˜! +${reward} ê³¨ë“œ íšë“.`);
            levelUpIfNeeded();
            state.monster = createMonster();
            render();
            return;
          }

          hero.hp -= monster.atk;
          writeLog(`ğŸ’¥ ${monster.name} ë°˜ê²©! ê¸°ì‚¬ì—ê²Œ ${monster.atk} í”¼í•´.`);
          if (hero.hp < 0) hero.hp = 0;
          render();
        }

        function resetGame() {
          state.auto = true;
          state.tickMs = 700;
          state.gold = 0;
          state.kills = 0;
          state.hero = { level: 1, maxHp: 140, hp: 140, atk: 18 };
          state.monster = createMonster();
          el.log.innerHTML = '';
          writeLog('ê²Œì„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
          render();
        }

        el.toggleAutoBtn.addEventListener('click', () => {
          state.auto = !state.auto;
          writeLog(state.auto ? 'â–¶ï¸ ìë™ ì „íˆ¬ë¥¼ ì¬ê°œí–ˆìŠµë‹ˆë‹¤.' : 'â¸ï¸ ìë™ ì „íˆ¬ë¥¼ ë©ˆì·„ìŠµë‹ˆë‹¤.');
          render();
        });

        el.manualAttackBtn.addEventListener('click', () => fightOnce(true));

        el.healBtn.addEventListener('click', () => {
          const heal = Math.min(state.hero.maxHp - state.hero.hp, 45);
          if (heal <= 0) {
            writeLog('ğŸ§ª ì´ë¯¸ ì²´ë ¥ì´ ê°€ë“ ì°¨ ìˆìŠµë‹ˆë‹¤.');
            return;
          }
          state.hero.hp += heal;
          writeLog(`ğŸ§ª íšŒë³µ ë¬¼ì•½ ì‚¬ìš©! HP +${heal}`);
          render();
        });

        el.resetBtn.addEventListener('click', resetGame);

        setInterval(() => {
          if (state.auto) {
            fightOnce(false);
          }
        }, state.tickMs);

        resetGame();
      })();
    </script>
  </body>
</html>
